{"version":3,"sources":["webpack:///./src/apis/team.ts","webpack:///./src/views/components/dashboard/Team/JoinTeam.vue?9520","webpack:///./src/views/components/dashboard/Team/JoinTeam.vue","webpack:///./src/views/components/dashboard/Team/JoinTeam.vue?2bcf"],"names":["post","get","useRequest","TeamInviteType","createTeam","payload","getTeams","getTeamDetail","teamId","getTeamDocs","getTeamInviteInfo","inviteId","getTeamMembers","createTeamInviteLink","inviterUserId","targetUserId","acceptTeamInvite","_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_1","class","_hoisted_2","key","_hoisted_3","_hoisted_4","_hoisted_5","_createElementVNode","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_createTextVNode","_defineComponent","__name","setup","__props","route","useRoute","params","teamInfo","ref","inviteInfo","inviterInfo","loginState","storeToRefs","useDashboardStore","async","getData","team","invite","value","inviter","getUserInfoById","handleAcceptInviteAfterLogin","confirm","title","content","okText","cancelText","centered","onOk","localStorage","setItem","router","push","name","handleJoin","getItem","res","message","success","setTimeout","path","id","onMounted","_ctx","_cache","_component_Avatar","_resolveComponent","_component_Button","_openBlock","_createElementBlock","_createVNode","size","src","logo","draggable","_toDisplayString","_unref","getName","outdateTimestamp","Math","ceil","Date","now","_createCommentVNode","type","onClick","$event","default","_withCtx","_","__exports__"],"mappings":"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","file":"js/chunk-3ebce330.74c01065.js","sourcesContent":["import useRequest from '@/hooks/useRequest'\nimport { UserInfo } from '@authing/browser/dist/types/global'\nimport { Docs } from './docs'\n\nconst { post, get } = useRequest()\n\nexport interface Team {\n  id: string // authing tanantId\n  name: string\n  logo?: string\n  description?: string\n}\n\nexport type CreateTeamPayload = {\n  name: string\n  description?: string\n  logoUrl?: string\n}\n\nexport type TeamDetail = {\n  team: Team\n  docs: Docs[]\n}\n\nexport type TeamMemberResponse = {\n  list: Array<{\n    id: string\n    tenantId: string\n    user: UserInfo\n  }>\n  listTotal: number\n}\n\nexport enum TeamInviteType {\n  INDIVIDUAL = 1,\n  PUBLIC = 2,\n}\n\nexport type TeamInvite = {\n  _id: string\n  inviterUserId: string\n  targetUserId?: string\n  teamId: string\n  type: TeamInviteType\n  outdateTimestamp: number\n}\n\nexport function createTeam(payload: CreateTeamPayload) {\n  return post<boolean>('/api/teams/create', payload)\n}\n\nexport function getTeams() {\n  return get<Team[]>('/api/teams', {})\n}\n\nexport function getTeamDetail(teamId: string) {\n  return get<Team>(`/api/teams/${teamId}/detail`)\n}\n\nexport function getTeamDocs(teamId: string) {\n  return get<Docs[]>(`/api/teams/${teamId}/docs`)\n}\n\nexport function getTeamInviteInfo(inviteId: string) {\n  return get<{\n    team: Team\n    invite: TeamInvite\n  }>(`/api/teams/invites/${inviteId}`)\n}\n\nexport function getTeamMembers(teamId: string) {\n  return get<TeamMemberResponse>(`/api/teams/${teamId}/members`)\n}\n\nexport function createTeamInviteLink(teamId: string, inviterUserId: string, targetUserId?: string) {\n  return post<string>(`/api/teams/invites/${teamId}`, {\n    inviterUserId,\n    targetUserId,\n  })\n}\n\nexport function acceptTeamInvite(inviteId: string) {\n  return post<boolean>(`/api/teams/invites/${inviteId}/accept`, {})\n}\n","export * from \"-!../../../../../node_modules/.pnpm/mini-css-extract-plugin@0.9.0_webpack@4.46.0/node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../node_modules/.pnpm/css-loader@3.6.0_webpack@4.46.0/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../node_modules/.pnpm/vue-loader@16.8.3_5vqgdkn543z7gobmtemdwwisxa/node_modules/vue-loader/dist/stylePostLoader.js!../../../../../node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../node_modules/.pnpm/sass-loader@8.0.2_sass@1.54.5/node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../node_modules/.pnpm/cache-loader@4.1.0_webpack@4.46.0/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/.pnpm/vue-loader@16.8.3_5vqgdkn543z7gobmtemdwwisxa/node_modules/vue-loader/dist/index.js??ref--1-1!./JoinTeam.vue?vue&type=style&index=0&id=4691cd0c&lang=scss&scoped=true\"","import { defineComponent as _defineComponent } from 'vue'\nimport { resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-4691cd0c\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"join-invite-page\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"invite-card\"\n}\nconst _hoisted_3 = { class: \"content\" }\nconst _hoisted_4 = { class: \"bold\" }\nconst _hoisted_5 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", null, \" 的 \", -1))\nconst _hoisted_6 = { class: \"bold\" }\nconst _hoisted_7 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, \" 正在邀请你加入团队 \", -1))\nconst _hoisted_8 = {\n  key: 0,\n  class: \"tips\"\n}\nconst _hoisted_9 = /*#__PURE__*/_createTextVNode(\"加入团队\")\n\nimport { onMounted, ref } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { getTeamInviteInfo, Team, TeamInvite, acceptTeamInvite } from '@/apis/team'\nimport { getUserInfoById } from '@/apis/user'\nimport { User } from 'authing-js-sdk'\nimport { getName } from '@/utils/authing'\nimport { message, Modal } from 'ant-design-vue'\nimport router from '@/views/router'\nimport { storeToRefs } from 'pinia'\nimport { useDashboardStore } from '@/store'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'JoinTeam',\n  setup(__props) {\n\nconst route = useRoute()\nconst { inviteId } = route.params as Record<string, string>\nconst teamInfo = ref<Team>()\nconst inviteInfo = ref<TeamInvite>()\nconst inviterInfo = ref<User>()\n\nconst { loginState } = storeToRefs(useDashboardStore())\n\nasync function getData() {\n  const { team, invite } = await getTeamInviteInfo(inviteId)\n  teamInfo.value = team\n  inviteInfo.value = invite\n  const inviter = await getUserInfoById(invite?.inviterUserId)\n  inviterInfo.value = inviter\n}\n\nfunction handleAcceptInviteAfterLogin() {\n  Modal.confirm({\n    title: '未登录',\n    content: '加入团队前，请先登录账号',\n    okText: '去登录',\n    cancelText: '取消',\n    centered: true,\n    onOk: () => {\n      localStorage.setItem('inviteId', inviteId)\n      router.push({\n        name: 'login',\n      })\n    }\n  })\n}\n\nasync function handleJoin() {\n  if (!loginState.value && !localStorage.getItem('token')) {\n    handleAcceptInviteAfterLogin()\n    return\n  }\n  const res = await acceptTeamInvite(inviteId)\n  if (res) {\n    void message.success(`你已成功加入 ${teamInfo.value?.name}`)\n    setTimeout(() => {\n      router.push({\n        path: `/team/${teamInfo.value?.id}`\n      })\n    }, 1000)\n  }\n}\n\nonMounted(() => {\n  void getData()\n})\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_Avatar = _resolveComponent(\"Avatar\")!\n  const _component_Button = _resolveComponent(\"Button\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (teamInfo.value && inviteInfo.value && inviterInfo.value)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n          _createVNode(_component_Avatar, {\n            size: 100,\n            src: teamInfo.value?.logo,\n            draggable: false\n          }, null, 8, [\"src\"]),\n          _createElementVNode(\"div\", _hoisted_3, [\n            _createElementVNode(\"div\", null, [\n              _createElementVNode(\"span\", _hoisted_4, _toDisplayString(teamInfo.value?.name), 1),\n              _hoisted_5,\n              _createElementVNode(\"span\", _hoisted_6, _toDisplayString(_unref(getName)(inviterInfo.value)), 1)\n            ]),\n            _hoisted_7,\n            (inviteInfo.value?.outdateTimestamp)\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"这个邀请链接将在 \" + _toDisplayString(Math.ceil((inviteInfo.value.outdateTimestamp -\n              Date.now()) / 86400000)) + \" 天后过期\", 1))\n              : _createCommentVNode(\"\", true)\n          ]),\n          _createVNode(_component_Button, {\n            type: \"primary\",\n            class: \"primary-btn-large\",\n            onClick: _cache[0] || (_cache[0] = ($event: any) => (handleJoin()))\n          }, {\n            default: _withCtx(() => [\n              _hoisted_9\n            ]),\n            _: 1\n          })\n        ]))\n      : _createCommentVNode(\"\", true)\n  ]))\n}\n}\n\n})","import script from \"./JoinTeam.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./JoinTeam.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./JoinTeam.vue?vue&type=style&index=0&id=4691cd0c&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/ken/workspace/PPTist/node_modules/.pnpm/vue-loader@16.8.3_5vqgdkn543z7gobmtemdwwisxa/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4691cd0c\"]])\n\nexport default __exports__"],"sourceRoot":""}